@inject WebSocketService WsService

<h3>WebSocket Panel</h3>

<div class="mb-3">
    <label class="form-label">Server IP</label>
    <input class="form-control" @bind="serverIp" placeholder="ws://127.0.0.1:8080" />
</div>

<div class="mb-3 d-flex flex-wrap gap-2">
    <button class="btn btn-success" @onclick="Connect" disabled="@isConnected">Connect</button>
    <button class="btn btn-danger" @onclick="Disconnect" disabled="@(!isConnected)">Disconnect</button>
</div>

<div class="mb-2">
    <span>Connection Status:</span>
    <strong class="@statusClass ms-2">@statusMessage</strong>
</div>

@code {
    string serverIp = "ws://192.168.64.156:9090";
    string statusMessage = "Not connected";

    bool isConnected => statusMessage == "Connected";
    string statusClass => isConnected ? "text-success" : "text-danger";

    protected override void OnInitialized()
    {
        WsService.OnStatusChanged += (msg) =>
        {
            statusMessage = msg;
            InvokeAsync(StateHasChanged);
        };
    }

    async Task Connect() => await WsService.ConnectAsync(serverIp);
    async Task Disconnect() => await WsService.DisconnectAsync();
}